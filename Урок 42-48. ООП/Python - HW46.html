<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Python - HW46</title>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@100..900&family=JetBrains+Mono:ital,wght@0,100..800;1,100..800&display=swap" rel="stylesheet">
  <style>
    body {
      background: linear-gradient(to right, #333333 0%, #404040 57%, #363636 100%);
      color: #fff;
      font-family: "Inter", sans-serif;
      margin: 0px;
    }

    .container {
      display: flex;
      flex-direction: row;
    }

    .sidebar {
      width: 240px;
      height: 280px;
      display: flex;
      flex-direction: column;
      align-items: center;
      box-sizing: border-box;
      position: sticky;
      top: 0;
    }

    .sidebar img {
      height: 240px;
      width: 240px;
    }

    .sidebar #copyrights {
      background: linear-gradient(to right, #343434 0%, #363636 100%);
      -webkit-background-clip: text;
      color: transparent;
    }

    .right-block {
      flex: 1;
      width: 70%;
      gap: 50px;
      box-sizing: border-box;
      display: flex;
      flex-direction: column;
      padding: 50px 25px 50px 0;
      margin: 10px;
    }

    .right-rect {
      background-color: rgba(38, 38, 38, 0.75);
      box-shadow: 10px 10px 15px rgba(0, 0, 0, 0.6);
      padding: 30px 25px;
      border-radius: 10px;
    }

    .right-rect h2,
    .right-rect .hl-text {
      margin: 0;
      color: #FFC000;
    }

    .right-rect h3 {
      margin-top: 40px;
      margin-bottom: 0px;
      color: #FFC000;
    }

    .console {
      background-color: #1E1F22;
      border-radius: 5px;
      margin-top: 10px;
      position: relative;
    }

    p {
      margin-top: 15px;
      margin-bottom: 0px;
    }

    pre {
      white-space: pre-wrap;
      white-space: pre;
      overflow-x: auto;
      word-wrap: normal;
      padding: 20px 10px;
    }

    .console .input {
      color: #6AAB73;
      font-style: italic;
    }

    code {
      font-family: "JetBrains mono", monospace;
      color: #BCBEC4;
    }

    .copy-button {
      position: absolute;
      top: 5px;
      right: 5px;
      padding: 5px 10px;
      background-color: #FFC000;
      color: #1E1F22;
      border: none;
      border-radius: 5px;
      cursor: pointer;
      font-family: "JetBrains mono", monospace;
      font-weight: bold;
    }

    .string {
      color: #6AAB73;
      font-family: "JetBrains mono", monospace;
    }

    .string-bracket,
    .string-esc,
    .keyword {
      color: #CF8E6D;
      font-family: "JetBrains mono", monospace;
    }

    .self {
      color: #94558D;
      font-family: "JetBrains mono", monospace;
    }

    .string-bracket-inner {
      color: #BCBEC4;
      font-family: "JetBrains mono", monospace;
    }

    .number {
      color: #2AACB8;
      font-family: "JetBrains mono", monospace;
    }

    .comments {
      color: #7A7E85;
      font-family: "JetBrains mono", monospace;
    }

    .metadata {
      color: #B3AE60;
      font-family: "JetBrains mono", monospace;
    }

    .built-in {
      color: #8888C6;
      font-family: "JetBrains mono", monospace;
    }

    .function {
      color: #56A8F5;
      font-family: "JetBrains mono", monospace;
    }

    .special-names {
      color: #B200B2;
      font-family: "JetBrains mono", monospace;
    }

    .keyword-argument {
      color: #AA4926;
      font-family: "JetBrains mono", monospace;
    }
  </style>
</head>

<body>
  <div class="container">
    <div class="sidebar">
      <img src="https://i.imgur.com/S9prf0J.png" alt="STEP IT Academy">
      <p id="copyrights">© Фикрет Зейналов, 2024</p>
    </div>
    <div class="right-block">
      <div class="right-rect">
        <h2>Домашнее Задание 46.1</h2>
        <p>Создайте класс <span class="hl-text">"Payment"</span>. Этот класс должен <span class="hl-text">хранить поля для названия сервиса</span> и <span class="hl-text">процента комиссии</span>.
          <br>Для класса определите <span class="hl-text">конструктор</span> и <span class="hl-text">свойства</span>.
          <br>Для класса определите <span class="hl-text">метод "Сделать оплату", который принимает сумму</span> и <span class="hl-text">возвращает сумму с процентом</span>.
        </p>
        <p>Создайте класс <span class="hl-text">"PaypalPayment"</span>, который наследуется от <span class="hl-text">"Payment"</span>. Переопределите для него <span class="hl-text">конструктор</span> и <span class="hl-text">метод оплаты</span>.
          <br>Конструктор <span class="hl-text">ничего не должен принимать</span>, а должен вызывать <span class="hl-text">конструктор родителя</span> и <span class="hl-text">передавать ему</span> строку <span class="string"><b>"Paypal"</b></span> и число <span class="number"><b>5</b></span>.
          <br>Метод оплаты переопределите так, чтобы сперва <span class="hl-text">проверял принимаемую сумму</span>. Если сумма меньше <span class="number"><b>5000</b></span>, то <span class="hl-text">вызывается родительский метод оплаты</span> и <span class="hl-text">возвращается то, что вернёт родительский метод</span>. В противном случае <span class="hl-text">возвращается</span> <span class="number"><b>0</b></span>.
        </p>
        <p>Создайте класс <span class="hl-text">"CreditCardPayment"</span>, который наследуется от <span class="hl-text">"Payment"</span>. Дополните его полем баланса. Переопределите для него <span class="hl-text">конструктор</span> и <span class="hl-text">метод оплаты</span>.
          <br>Конструктор <span class="hl-text">должен принимать баланс</span>, вызывать <span class="hl-text">конструктор родителя</span> и <span class="hl-text">передавать ему</span> строку <span class="string"><b>"Credit Card"</b></span> и число <span class="number"><b>1.5</b></span>. После этого он должен выставлять в своё поле <span class="hl-text">баланс</span>.
          <br>Метод оплаты переопределите так, чтобы сперва <span class="hl-text">вызывался родительский метод оплаты</span>. Если вернувшаяся сумма меньше-равна баланса, то <span class="hl-text">из баланса отнимается эта сумма</span> и <span class="hl-text">возвращается отнимаемая сумма</span>. В противном случае <span class="hl-text">возвращается</span> <span class="number"><b>0</b></span>.
          <br>Дополните класс <span class="hl-text">геттером баланса</span>.
        </p>
        <p>Создайте класс <span class="hl-text">"BonusCardPayment"</span>, который наследуется от <span class="hl-text">"Payment"</span>. Дополните его полем баланса. Переопределите для него <span class="hl-text">конструктор</span> и <span class="hl-text">метод оплаты</span>.
          <br>Конструктор <span class="hl-text">должен принимать баланс</span>, вызывать <span class="hl-text">конструктор родителя</span> и <span class="hl-text">передавать ему</span> строку <span class="string"><b>"Bonus Card"</b></span> и число <span class="number"><b>0</b></span>. После этого он должен выставлять в своё поле <span class="hl-text">баланс</span>.
          <br>Метод оплаты переопределите так, чтобы сперва <span class="hl-text">вызывался родительский метод оплаты</span>. Если вернувшаяся сумма меньше-равна баланса, то <span class="hl-text">из баланса отнимается эта сумма</span> и <span class="hl-text">возвращается отнимаемая сумма</span>. В противном случае <span class="hl-text">возвращается</span> <span class="number"><b>0</b></span>.
          <br>Дополните класс <span class="hl-text">геттером баланса</span>.
        </p>

        <p>После описания классов для самопроверки используйте код ниже. Если всё в порядке, то при запуске кода, в консоли Вы увидете, что все тесты пройдены.
        <div class="console">
          <button class="copy-button" onclick="copyCode(this)"><svg xmlns="http://www.w3.org/2000/svg" width="15" height="15" fill="none" viewBox="0 0 24 24" class="icon-sm">
              <path fill="currentColor" fill-rule="evenodd" d="M7 5a3 3 0 0 1 3-3h9a3 3 0 0 1 3 3v9a3 3 0 0 1-3 3h-2v2a3 3 0 0 1-3 3H5a3 3 0 0 1-3-3v-9a3 3 0 0 1 3-3h2zm2 2h5a3 3 0 0 1 3 3v5h2a1 1 0 0 0 1-1V5a1 1 0 0 0-1-1h-9a1 1 0 0 0-1 1zM5 9a1 1 0 0 0-1 1v9a1 1 0 0 0 1 1h9a1 1 0 0 0 1-1v-9a1 1 0 0 0-1-1z" clip-rule="evenodd"></path>
            </svg>
            Copy code</button>
          <pre><code class="python">payments_amount = (4000, 6500, 500, 995, 600, 700, 25)
payments_balance = (None, None, 1000, 1000, 1000, 200, -500)
payments = (PaypalPayment(), PaypalPayment(),
            CreditCardPayment(payments_balance[2]), CreditCardPayment(payments_balance[2]),
            BonusCardPayment(payments_balance[4]), BonusCardPayment(payments_balance[5]),
            BonusCardPayment(payments_balance[6]))
payments_correct_returns = (4200, 0, 507.5, 0, 600, 700, 0)

for i in range(len(payments_amount)):
    payment = payments[i]
    payment_amount = payments_amount[i]
    payment_correct_return = payments_correct_returns[i]

    payment_return = payment.make_payment(payment_amount)

    if payment_return == payment_correct_return:
        print(f"===== TEST {i} - Success =====")
    else:
        print(f"===== TEST {i} - Fail =====")

    payment_name = payment.get_name()
    print(f"Payment type: {payment_name}")
    print(f"Payment amount: {payment_amount}")
    print(f"Payment correct return: {payment_correct_return}")
    print(f"Payment actual return: {payment_return}")
    if isinstance(payment, CreditCardPayment) or isinstance(payment, BonusCardPayment):
        print(f"Payment balance BEFORE payment: {payments_balance[i]}")
        print(f"Payment balance AFTER payment: {payment.get_balance()}")
    print()</code></pre>
        </div>
        </p>
      </div>
      <div class="right-rect">
        <h2>Домашнее Задание 46.2</h2>
        <p>Переделайте класс StudentDB так, чтобы программа заработала.
        <div class="console">
          <button class="copy-button" onclick="copyCode(this)"><svg xmlns="http://www.w3.org/2000/svg" width="15" height="15" fill="none" viewBox="0 0 24 24" class="icon-sm">
              <path fill="currentColor" fill-rule="evenodd" d="M7 5a3 3 0 0 1 3-3h9a3 3 0 0 1 3 3v9a3 3 0 0 1-3 3h-2v2a3 3 0 0 1-3 3H5a3 3 0 0 1-3-3v-9a3 3 0 0 1 3-3h2zm2 2h5a3 3 0 0 1 3 3v5h2a1 1 0 0 0 1-1V5a1 1 0 0 0-1-1h-9a1 1 0 0 0-1 1zM5 9a1 1 0 0 0-1 1v9a1 1 0 0 0 1 1h9a1 1 0 0 0 1-1v-9a1 1 0 0 0-1-1z" clip-rule="evenodd"></path>
            </svg>
            Copy code</button>
          <pre><code class="python">class Student:
    __username = ""
    __f_name = ""
    __l_name = ""

    def __init__(self, username: str, f_name: str, l_name: str):
        self.__username = username
        self.__f_name = f_name.title()
        self.__l_name = l_name.title()

    def __str__(self):
        return f"{self.__username} {self.__f_name} {self.__l_name}"

    def get_username(self):
        return self.__username


class StudentDB:
    __student_list = list()

    def __init__(self, students: list[Student] = list):
        self.__student_list = students

    def get_students(self):
        return tuple(self.__student_list)


student_1 = Student("Teston_xyz", "Teston", "Lebra")
student_2 = Student("Tom_267", "Tom", "Jackson")
db = StudentDB([student_1, student_2])
for student in db.get_students():
    print(student)

student_3 = Student("AT_red", "Astrid", "Hofferson")
if student_3 in db:  # False
    print("Found")
else:
    print("Not found")
print()

db + student_3  # Добавляется новый студент
for student in db.get_students():
    print(student)

if student_3 in db:  # True
    print("Found")
else:
    print("Not found")
print()

student_4 = Student("AT_red", "NOT", "ADDED")
db + student_4  # Ничего не происходит, так как идентификатор уже присутствует
for student in db.get_students():
    print(student)</code></pre>
        </div>
        </p>
      </div>
    </div>
  </div>
  <script>
    function copyCode(button) {
      var codeBlock = button.nextElementSibling.querySelector('code');
      var range = document.createRange();
      range.selectNode(codeBlock);
      window.getSelection().removeAllRanges();
      window.getSelection().addRange(range);
      document.execCommand('copy');
      window.getSelection().removeAllRanges();
      changeCopyButton(button);
    }

    function changeCopyButton(button) {
      var originalHTML = button.innerHTML;
      button.innerHTML = `
        <svg width="15" height="15" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" class="icon-sm"><path fill-rule="evenodd" clip-rule="evenodd" d="M18.0633 5.67375C18.5196 5.98487 18.6374 6.607 18.3262 7.06331L10.8262 18.0633C10.6585 18.3093 10.3898 18.4678 10.0934 18.4956C9.79688 18.5234 9.50345 18.4176 9.29289 18.2071L4.79289 13.7071C4.40237 13.3166 4.40237 12.6834 4.79289 12.2929C5.18342 11.9023 5.81658 11.9023 6.20711 12.2929L9.85368 15.9394L16.6738 5.93664C16.9849 5.48033 17.607 5.36263 18.0633 5.67375Z" fill="currentColor"></path></svg>Copied!
    `;
      setTimeout(function() {
        button.innerHTML = originalHTML;
      }, 2000);
    }
    document.addEventListener('DOMContentLoaded', function() {
      const codeBlocks = document.querySelectorAll('code.python');
      codeBlocks.forEach(function(codeBlock, index) {
        let innerHTML = codeBlock.innerHTML;
        console.log(index, innerHTML);
        // STRING
        let regex = /(?<!\\)(f?"[^"\\]*(?:\\.[^"\\]*)*")/g;
        innerHTML = innerHTML.replace(regex, (match) => {
          return `<span class="string">${match}</span>`;
        });
        regex = /(?<!\\)(f?'[^'\\]*(?:\\.[^'\\]*)*')/g;
        innerHTML = innerHTML.replace(regex, (match) => {
          return `<span class="string">${match}</span>`;
        });
        // KEYWORD CLASS
        regex = /(class)(?!=)/g;
        innerHTML = innerHTML.replace(regex, (match) => {
          return `<span class="keyword">${match}</span>`;
        });
        // KEYWORDS
        const keywords = [
          'def', 'for', 'in', 'while', 'and', 'or', 'not',
          'if', 'elif', 'else', 'continue', 'break', 'try', 'with',
          'as', 'except', 'finally', 'return', 'True', 'False', 'from', 'import', 'del', 'None'
        ];
        regex = new RegExp(`\\b(${keywords.join('|')})\\b`, 'g');
        innerHTML = innerHTML.replace(regex, (match) => {
          return `<span class="keyword">${match}</span>`;
        });
        // KEYWORD NUMBER
        regex = /\b\d+(\.\d+)?/g;
        innerHTML = innerHTML.replace(regex, (match) => {
          return `<span class="number">${match}</span>`;
        });
        // STRING-ESC
        regex = /\\./g;
        innerHTML = innerHTML.replace(regex, (match) => {
          return `<span class="string-esc">${match}</span>`;
        });
        // COMMENTS
        regex = /(#.*$)/gm;
        innerHTML = innerHTML.replace(regex, (match) => {
          return `<span class="comments">${match}</span>`;
        });
        // METADATA
        regex = /^(\s*@\w+)/gm;
        innerHTML = innerHTML.replace(regex, (match) => {
          return `<span class="metadata">${match}</span>`;
        });
        // SELF
        regex = /\bself\b/g;
        innerHTML = innerHTML.replace(regex, (match) => {
          return `<span class="self">${match}</span>`;
        });
        // BUILT-IN
        regex = /\b(open|print|input|int|float|str|list|set|dict|range|len|sum|min|max|sort|isinstance)\b/g;
        innerHTML = innerHTML.replace(regex, (match) => {
          return `<span class="built-in">${match}</span>`;
        });
        // FUNCTION
        regex = /(<span class="keyword">def<\/span>)\s(\w+)\(/g;
        innerHTML = innerHTML.replace(regex, '$1 <span class="function">$2</span>(');
        // SPECIAL-NAMES
        regex = /(<span class="function">)(__\w+__)(<\/span>)/g;
        innerHTML = innerHTML.replace(regex, '$1<span class="special-names">$2</span>$3');
        // KEYWORD-ARGUMENT
        regex = /, (end|sep)=/g;
        innerHTML = innerHTML.replace(regex, ', <span class="keyword-argument">$1</span>=');
        codeBlock.innerHTML = innerHTML
      });
    });
  </script>
</body>